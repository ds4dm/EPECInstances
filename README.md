
# General description
Goverments act as Stackelberg leaders by trading energy, with the aim of minimizing their emissions, and eventually to maximize tax revenues. Within each country, energy producers act as Stackelberg followers and play a Nash game between themselves, aiming to maximize their profits given the regulations from Goverments.
Each country is interested to impose a tax that is not preventing profitable domestic production, as it is constrained to keep the domestic energy price less than a predetermined threshold. We present the optimization problems of the players formally below. For ease of understanding the quantities in {\color{rosso}red} are parameters, i.e., inputs to the model. And the quantities in {\color{blue}blue} are decision variables, decided by the country. Quantities in {\color{green}green} are variables of a {\em different} player influencing the country's problem.
Each country <p align="center"><img src="svgs/e242d5dd2ef4ef762db8b72b38a17315.svg?invert_in_darkmode" align=middle width=12.924643049999998pt height=11.232861749999998pt/></p> solves the following problem.
<p align="center"><img src="svgs/8990b38b8ae969ed961533e17808d9fa.svg?invert_in_darkmode" align=middle width=348.8545302pt height=59.1786591pt/></p>

<p align="center"><img src="svgs/401626e4c8788a77c59dfc61eaea9ef2.svg?invert_in_darkmode" align=middle width=72.23747189999999pt height=12.689460299999999pt/></p>
<p align="center"><img src="svgs/0556bdc79bb85fb1e8a0995ef3877e13.svg?invert_in_darkmode" align=middle width=115.72793594999999pt height=59.1786591pt/></p>
<p align="center"><img src="svgs/6688a4b427ddf565a9a0c20587e04fc5.svg?invert_in_darkmode" align=middle width=116.28955965pt height=37.775108249999995pt/></p>
<p align="center"><img src="svgs/a431fc19bffe8cd433df112ba2741fff.svg?invert_in_darkmode" align=middle width=203.90430225pt height=16.438356pt/></p>

<p align="center"><img src="svgs/52cf85451c6e04f60ae9ccc58a10aee6.svg?invert_in_darkmode" align=middle width=0.0pt height=0.0pt/></p> is the emission penalty that <p align="center"><img src="svgs/3ceb13107024b0fcb56c22464beee0a1.svg?invert_in_darkmode" align=middle width=8.27056725pt height=10.2739725pt/></p> encounters while producing a unit quantity of energy. This number is the product of cost incurred due to the emission of one unit of greenhouse gases (<img src="svgs/fb4233a889fe13e0b491d9dbb7133f8f.svg?invert_in_darkmode" align=middle width=40.84925624999999pt height=22.465723500000017pt/>), and the quantity of GHG emitted for each unit of energy produced by the producer <p align="center"><img src="svgs/3ceb13107024b0fcb56c22464beee0a1.svg?invert_in_darkmode" align=middle width=8.27056725pt height=10.2739725pt/></p>. <p align="center"><img src="svgs/bc790e101587c84a446a653c89f8ef55.svg?invert_in_darkmode" align=middle width=0.0pt height=0.0pt/></p> dictates whether objective should include the tax revenue earned by the government or not. <p align="center"><img src="svgs/5ff0125eb156bb4f0c0a48753184f3d5.svg?invert_in_darkmode" align=middle width=0.0pt height=0.0pt/></p> is the quantity of energy produced by the producer <p align="center"><img src="svgs/9405315c9ac60f98b720bd5dba6d84a6.svg?invert_in_darkmode" align=middle width=370.73625104999996pt height=44.0182545pt/></p>\qimp, \qexp<p align="center"><img src="svgs/4bd02268b9721cd4689f0dce3a288413.svg?invert_in_darkmode" align=middle width=345.3995028pt height=14.611878599999999pt/></p>\DemInt, \DemSlope<p align="center"><img src="svgs/793aaf790b6fc1b0e5cc1acb37d77c3a.svg?invert_in_darkmode" align=middle width=673.9026062999999pt height=14.611878599999999pt/></p>\DemInt - \DemSlope Q<p align="center"><img src="svgs/d11b027215eccf0c83fd56ed5362a7ec.svg?invert_in_darkmode" align=middle width=44.86319145pt height=11.4155283pt/></p>Q<p align="center"><img src="svgs/460896c4d83cf96250350c8292ed5e6a.svg?invert_in_darkmode" align=middle width=362.21774654999996pt height=14.611878599999999pt/></p>\piI[C']<p align="center"><img src="svgs/9f9c568c931a1b8ed7fdf821fbfd433b.svg?invert_in_darkmode" align=middle width=2212.5472115999996pt height=14.611878599999999pt/></p>\ti = \Cemm \textcolor{blue}{\bf t}^{\text{GHG}}<p align="center"><img src="svgs/31a86b4ca45878cddec5127b5a27c5e2.svg?invert_in_darkmode" align=middle width=584.0136785999999pt height=14.611878599999999pt/></p>\taxb<p align="center"><img src="svgs/1059b12a11e02eea8f59f401f0c1e722.svg?invert_in_darkmode" align=middle width=807.3293448pt height=50.776263449999995pt/></p> solves is as follow.
<p align="center"><img src="svgs/a10f10dec3ac44b165ecbec71087a614.svg?invert_in_darkmode" align=middle width=289.12528755pt height=59.1786591pt/></p>
<p align="center"><img src="svgs/60b9c85a219592c9b6e79ef978e51275.svg?invert_in_darkmode" align=middle width=135.2510742pt height=12.82874835pt/></p>
The first two terms in the objective correspond to the cost incurred by the energy producer, while the third term is the tax expense. The the parenthesis results in the revenue of <p align="center"><img src="svgs/3ceb13107024b0fcb56c22464beee0a1.svg?invert_in_darkmode" align=middle width=8.27056725pt height=10.2739725pt/></p>, which is the product of domestic price and the quantity produced. Further, the producer is constrained by their capacity limits. Note that the product of variables (<p align="center"><img src="svgs/5aa71f3ea4fc93d46e433ee929c7c9c1.svg?invert_in_darkmode" align=middle width=0.0pt height=0.0pt/></p>) in the objective does not pose any additional difficulty to the problem. This is because the follower's problem is still convex quadratic for a {\em fixed} value of <p align="center"><img src="svgs/ffca55cc174f0cfe3e999b0c9a3b17e6.svg?invert_in_darkmode" align=middle width=0.0pt height=0.0pt/></p> and the KKT conditions now give complementarity constraints with only linear terms.
